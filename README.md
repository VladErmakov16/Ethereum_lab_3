Отчет о лабораторной работе №3

Лабораторная работа охватывает важные аспекты взаимодействия с смарт-контрактом на блокчейне Ethereum с использованием библиотеки Web3.py в языке программирования Python. В данном отчете я предоставлю обзор основных шагов и деталей реализации кода.

Шаг 1: Написание смарт-контракта

Адрес смарт-контракта: 0x90268C542A261Db2D5294a52D7E0F363799cF343

Контракт предоставляет две функции для доступа к данным. Функция setData позволяет устанавливать новое значение переменной data, а функция getData позволяет получить текущее значение data. Владелец может быть изменен с помощью функции transferOwnership, но новый владелец должен быть допустимым Ethereum-адресом, и это действие вызывает событие. Контракт содержит два важных события: DataUpdated и OwnershipTransferred. Событие DataUpdated вызывается при изменении переменной data и содержит информацию о пользователе, который выполнил изменение, и новом значении переменной. Событие OwnershipTransferred вызывается при изменении владельца контракта и также содержит информацию о предыдущем и новом владельце.

Шаг 2: Подключение к узлу Ethereum
В начале работы происходит подключение к узлу Ethereum с использованием Infura.

Шаг 3: Определение адреса и приватного ключа

Для подписи и отправки транзакций необходим адрес кошелька и его соответствующий приватный ключ. В примере представлен адрес acc1 и приватный ключ private_key.

Шаг 4: Определение адреса смарт-контракта и ABI

Адрес вашего смарт-контракта определяется в contract_address, а ABI контракта определяется в contract_abi. ABI - это описание методов и событий, которые смарт-контракт может обрабатывать.

Шаг 5: Создание экземпляра смарт-контракта

С использованием Web3.py создается экземпляр смарт-контракта, который позволяет вызывать методы и получать информацию о контракте.

Шаг 6: Подготовка и отправка транзакции для функции setData

Выполняется вызов функции setData с передачей нового значения. Транзакция собирается с помощью build_transaction, подписывается с использованием приватного ключа и отправляется в блокчейн. Полученный хэш транзакции выводится на экран.

Хэш транзакции: 0x847518d4dd9a59d8c085e3148cb2a19bd9aa6e6577ee1474c8374b8b3b28378b

Шаг 7: Подготовка и отправка транзакции для функции transferOwnership

То же самое происходит для функции transferOwnership, где новому владельцу передается контроль над смарт-контрактом.

Хэш транзакции: 0x5ee7e4c14410912adad9018e4924cc9c1505b178660a24af7440f3c47bb6e10e

Шаг 8: Получение и подписка на события

С помощью контракта, можно получать логи событий, произошедших на контракте. Функция get_contract_events извлекает события DataUpdated, а функция subscribe_to_data_updated_events подписывается на будущие события DataUpdated. Аналогично, выполняется для события OwnershipTransferred.

Выводы

Эта лабораторная работа предоставляет пример взаимодействия с смарт-контрактом на Ethereum с использованием Python и библиотеки Web3.py. Она включает в себя создание и отправку транзакций, получение событий и их подписку, а также управление смарт-контрактом. 
